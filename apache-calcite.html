<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>  Apache Calcite
 | Hester's Blog</title>

    <meta name="author" content="Hester"/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css"/>
    <link rel="stylesheet" href="/theme/css/jquery.mglass.css"/>
    <link rel="stylesheet" href="/theme/css/pygment-solarized-dark.css"/>
    <link rel="stylesheet" href="/theme/css/style.css"/>

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>


    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <!-- Feeds -->


  </head>

  <body>

    <div class="container">

      <div class="page-header">
        <h1><a href="">Hester's Blog</a> <small></small></h1>
      </div>

      <nav class="navbar navbar-default">

        <!-- Hamburger menu for mobile -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#plumage-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="" title="">Hester's Blog</a>
        </div>

        <!-- Menus and search forms -->
        <div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">

          <ul class="nav navbar-nav">
<li >
                  <a href="/category/bigdata.html">BigData</a>
                </li>
<li >
                  <a href="/category/blog.html">Blog</a>
                </li>
<li >
                  <a href="/category/book-note.html">Book Note</a>
                </li>
<li >
                  <a href="/category/front-end-note.html">Front End Note</a>
                </li>
<li >
                  <a href="/category/gui-note.html">GUI Note</a>
                </li>
<li >
                  <a href="/category/java.html">java</a>
                </li>
<li  class="active" >
                  <a href="/category/java-note.html">Java Note <span class="sr-only">(current)</span></a>
                </li>
<li >
                  <a href="/category/spring.html">Spring</a>
                </li>
          </ul>



        </div>

      </nav>

    </div>


    <div class="container main">


      <div class="row">
        <div class=" col-md-9  ">
  <h1>
    <a href="/apache-calcite.html" rel="bookmark" title="Permalink to Apache Calcite">Apache Calcite</a>
  </h1>
        </div>
      </div>

      <div class="row">


        <div class=" col-md-9 " id="content" role="main">
  

  <div>
    <h2>主要功能</h2>
<ol>
<li>标准的SQL解析，校验以及提供JDBC驱动</li>
<li>将SQL转换为关系代数，基于成本模型进行优化</li>
<li>适配第三方数据源</li>
</ol>
<h2>官方文档</h2>
<p>https://calcite.apache.org/docs/</p>
<p>Apache Calcite 定位是一款动态数据管理框架。数据库管理系统的很多功能它都具备，但是有几个功能是它不具备的
1. 数据存储
2. 数据处理算法
3. 元数据管理</p>
<p>Calcite本身的定位就是脱离数据存储和处理，它其实可以作为应用与数据存储，数据处理引擎之间的媒介(但是感觉和ORM又完全不同)，它也可以作为构建数据库的基础。</p>
<p>Calcite可以处理任何数据源，任何数据格式。只要写一个<strong>适配器</strong>告知Calcite哪些集合可以视为一张表，就可以将这些集合视为数据源。</p>
<p>用户也可以自定义优化规则，用于操作新格式的数据、注册新的运算(例如更优的join算法)、优化sql查询。Calcite可以基于代价优化生成高效的执行计划。</p>
<h3>CSV文件的适配器</h3>
<p>功能: 完成一个适配器，将一个包含CSV文件的目录作为数据库，每一个文件作为一张表，Calcite用于提供SQL接口(只是SQL查询)</p>
<p>几个关键的功能点
1. 使用<strong>SchemaFactory</strong>和<strong>Schema</strong>接口定义schema
2. 使用json声明表结构
3. 使用json声明视图
4. 使用<strong>Table</strong>接口定义表
5. 定义记录的类型
6. 使用<strong>ScannableTable</strong>接口简单实现了一张表
7. 使用<strong>FilterableTable</strong>接口实现了一个更复杂，有过滤功能的表
8. 使用<strong>TranslatableTable</strong>接口实现了一个支持关系代数运算的表，背后是把关系运算转换为执行计划</p>
<h4>Schema发现机制</h4>
<p>Calcite的核心功能是解析不了CSV文件的，换句话说，它是一个没有数据存储层的数据库，它并不感知任何数据格式</p>
<p>核心逻辑，基于<strong>schema factory</strong>定义schema，schema嵌套解析表，最终Calcite执行SQL完成查询</p>
<h2>其他资料</h2>
<p><a href="https://zhuanlan.zhihu.com/p/602840722">汇总</a>
<a href="https://io-meter.com/2019/03/16/streaming-incremental-sql-execution/">flink SQL实现原理</a>
<a href="https://www.youtube.com/watch?v=meI0W12f_nw">教程</a></p>
<p>概念汇总
| 名称 | 描述 |
| ---- | ------- |
| SQL | 最原始的请求，通过JDBC服务或其他协议由客户端传到服务端 |
| SqlNode | AST抽象语法树，第一层转换逻辑 |
| RelNode | Relation Expression 关系代数表达式，作为SQL优化的输入 |</p>
<p><img alt="架构" src="img/architecture.png">
<img alt="calcite的架构" src="img/calcite-architecture.png"></p>
<p>calcite是一个<strong>关系代数工具，把SQL转换为执行计划</strong>
如果想让calcite生成物理计划，并且执行物理计划，需要做到以下三点
1. 数据源的表有哪些，表包含哪些字段，总而言之，元数据 和SchemaFactory关联
2. 如何扫描一张表
3. 可选项，使用什么规则来优化执行计划</p>
  </div>



        </div>

          <div class="col-md-3">
  <div class="well">

    <p><abbr title="2023-03-05T18:32:00+08:00"><i class="fa fa-calendar"></i> 日 05 三月 2023</abbr></p>

      <p><address>
        <i class="fa fa-user"></i> By
          <a href="/author/hester.html" rel="author">Hester</a>
      </address></p>

    <hr/>

      <p>
              <a href="/category/java-note.html" rel="tag"
                  data-toggle="tooltip" class="label label-info"
                  title="8 articles in this category">Java Note</a>
      </p>
      <hr/>



  </div>
            
          </div>

      </div>

    </div>

    <!-- TODO: make footer sticky -->
    <footer class="container-fluid">
      <div class="container">
        <div class="row">

            <div class="col-md-2">
                <h5>Social</h5>
                <ul class="list-unstyled">
                  <li>  <a href="#">
      <i class="fa fa-external-link"></i>
    You can add links in your config file
  </a></li>
                  <li>  <a href="#">
      <i class="fa fa-external-link"></i>
    Another social link
  </a></li>
                </ul>
            </div>
            <div class="col-md-2">
                <h5>Links</h5>
                <ul class="list-unstyled">
                  <li>  <a href="http://getpelican.com/">
      <img src="https://icons.better-idea.org/icon?url=getpelican.com&size=16" width="16" height="16" class="icon" alt="getpelican.com icon"/>
    Pelican
  </a></li>
                  <li>  <a href="http://python.org/">
      <img src="https://icons.better-idea.org/icon?url=python.org&size=16" width="16" height="16" class="icon" alt="python.org icon"/>
    Python.org
  </a></li>
                  <li>  <a href="http://jinja.pocoo.org/">
      <img src="https://icons.better-idea.org/icon?url=jinja.pocoo.org&size=16" width="16" height="16" class="icon" alt="jinja.pocoo.org icon"/>
    Jinja2
  </a></li>
                  <li>  <a href="#">
      <i class="fa fa-external-link"></i>
    You can modify those links in your config file
  </a></li>
                </ul>
            </div>

          <div class="col-md-2">
            <h5>Browse content by</h5>
            <ul class="list-unstyled">
            </ul>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Copyright notice</h5>
            <p>© Copyright 2017-2024 Hester.</p>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Disclaimer</h5>
              <p>All opinions expressed in this site are my own personal opinions and are not endorsed by, nor do they represent the opinions of my previous, current and future employers or any of its affiliates, partners or customers.</p>
          </div>

          <div class="col-md-2">
          </div>

        </div>
      </div>

      <h5 class="text-right"><a href="#"><i class="fa fa-arrow-up"></i> Back to top</a></h5>

      <div class="container">
        <div class="row col-md-12 text-muted text-center">
          Site generated by <a href="https://getpelican.com"> Pelican</a>.<br/>
          <a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="https://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
      </div>

    </footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script src="/theme/js/jquery.mglass.js"></script>
    <script src="/theme/js/application.js"></script>

  </body>
</html>