<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>  实战项目笔记
 | Hester's Blog</title>

    <meta name="author" content="Hester"/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css"/>
    <link rel="stylesheet" href="/theme/css/jquery.mglass.css"/>
    <link rel="stylesheet" href="/theme/css/pygment-solarized-dark.css"/>
    <link rel="stylesheet" href="/theme/css/style.css"/>

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>


    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <!-- Feeds -->


  </head>

  <body>

    <div class="container">

      <div class="page-header">
        <h1><a href="">Hester's Blog</a> <small></small></h1>
      </div>

      <nav class="navbar navbar-default">

        <!-- Hamburger menu for mobile -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#plumage-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="" title="">Hester's Blog</a>
        </div>

        <!-- Menus and search forms -->
        <div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">

          <ul class="nav navbar-nav">
<li >
                  <a href="/category/bigdata.html">BigData</a>
                </li>
<li >
                  <a href="/category/blog.html">Blog</a>
                </li>
<li  class="active" >
                  <a href="/category/front-end-note.html">Front End Note <span class="sr-only">(current)</span></a>
                </li>
<li >
                  <a href="/category/gui-note.html">GUI Note</a>
                </li>
<li >
                  <a href="/category/java-note.html">Java Note</a>
                </li>
<li >
                  <a href="/category/spring.html">Spring</a>
                </li>
          </ul>



        </div>

      </nav>

    </div>


    <div class="container main">


      <div class="row">
        <div class=" col-md-9  ">
  <h1>
    <a href="/shi-zhan-xiang-mu-bi-ji.html" rel="bookmark" title="Permalink to 实战项目笔记">实战项目笔记</a>
  </h1>
        </div>
      </div>

      <div class="row">


        <div class=" col-md-9 " id="content" role="main">
  

  <div>
    <h2>工程结构</h2>
<div class="highlight"><pre><span></span><code><span class="err">src</span>
<span class="err">├── api 前后端接口</span>
<span class="err">├── assets 通用资源</span>
<span class="err">├── components UI组件</span>
<span class="err">├── containers 容器组件</span>
<span class="err">├── index.js 入口js</span>
<span class="err">├── redux redux状态控制相关</span>
<span class="err">└── utils 工具类</span>
</code></pre></div>


<h2>依赖的组件库</h2>
<h3>AntD</h3>
<p><a href="https://mobile.ant.design/docs/react/introduce-cn">antd官方文档</a></p>
<div class="highlight"><pre><span></span><code><span class="err">npm install antd-mobile --save</span>
</code></pre></div>


<p>修改<code>public/index.html</code></p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="c">&lt;!-- set `maximum-scale` for some compatibility issues --&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://as.alipayobjects.com/g/component/fastclick/1.0.6/fastclick.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;addEventListener&#39;</span> <span class="k">in</span> <span class="nb">document</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;DOMContentLoaded&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">FastClick</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
      <span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nb">Promise</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="s1">&#39;&lt;script src=&quot;https://as.alipayobjects.com/g/component/es6-promise/3.2.2/es6-promise.min.js&quot;&#39;</span><span class="o">+</span><span class="s1">&#39;&gt;&#39;</span><span class="o">+</span><span class="s1">&#39;&lt;&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="s1">&#39;script&gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>


<h3>打包工具实现按需打包</h3>
<div class="highlight"><pre><span></span><code><span class="n">npm</span> <span class="n">install</span> <span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">dev</span> <span class="n">babel</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="kn">import</span> <span class="nn">react</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">rewired</span> <span class="n">customize</span><span class="o">-</span><span class="n">cra</span>
</code></pre></div>


<p>定义加载配置的js
根目录创建<code>config-overrides.js</code></p>
<div class="highlight"><pre><span></span><code><span class="kr">const</span> <span class="p">{</span>
  <span class="nx">override</span><span class="p">,</span>
  <span class="nx">fixBabelImports</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;customize-cra&quot;</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">override</span><span class="p">(</span>
  <span class="nx">fixBabelImports</span><span class="p">(</span><span class="s2">&quot;babel-plugin-import&quot;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">libraryName</span><span class="o">:</span> <span class="s2">&quot;antd-mobile&quot;</span><span class="p">,</span>
    <span class="nx">style</span><span class="o">:</span> <span class="s2">&quot;css&quot;</span>
  <span class="p">})</span>
<span class="p">);</span>
</code></pre></div>


<p>修改package.json</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;scripts&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;react-app-rewired start&quot;</span><span class="p">,</span>
        <span class="nt">&quot;build&quot;</span><span class="p">:</span> <span class="s2">&quot;react-app-rewired build&quot;</span><span class="p">,</span>
        <span class="nt">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;react-app-rewired test --env=jsdom&quot;</span><span class="p">,</span>
        <span class="nt">&quot;eject&quot;</span><span class="p">:</span> <span class="s2">&quot;react-scripts eject&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<h3>路由配置</h3>
<p><a href="https://reacttraining.com/react-router/web/guides/quick-start">react-router-dom快速开始</a></p>
<div class="highlight"><pre><span></span><code><span class="err">npm install --save react-router-dom</span>
</code></pre></div>


<p>路由组件一般需要和redux交互，所以放到containers路径下</p>
<p>一级路由example</p>
<div class="highlight"><pre><span></span><code><span class="o">//</span> <span class="err">入口</span><span class="n">js代码</span>

<span class="kn">import</span> <span class="nn">React</span> <span class="nn">from</span> <span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">ReactDOM</span> <span class="nn">from</span> <span class="s2">&quot;react-dom&quot;</span>
<span class="kn">import</span> <span class="p">{</span><span class="n">BrowserRouter</span><span class="p">,</span> <span class="n">Route</span><span class="p">,</span> <span class="n">Switch</span><span class="p">}</span> <span class="kn">from</span> <span class="s2">&quot;react-router-dom&quot;</span>

<span class="kn">import</span> <span class="nn">Register</span> <span class="nn">from</span> <span class="s2">&quot;./containers/register/register&quot;</span>
<span class="kn">import</span> <span class="nn">Login</span> <span class="nn">from</span> <span class="s2">&quot;./containers/login/login&quot;</span>
<span class="kn">import</span> <span class="nn">Main</span> <span class="nn">from</span> <span class="s2">&quot;./containers/main/main&quot;</span>

<span class="n">ReactDOM</span><span class="o">.</span><span class="n">render</span><span class="p">((</span>
    <span class="o">&lt;</span><span class="n">BrowserRouter</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">Switch</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">Route</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/register&quot;</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">Register</span> <span class="o">/&gt;</span>
            <span class="o">&lt;/</span><span class="n">Route</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">Route</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/login&quot;</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">Login</span> <span class="o">/&gt;</span>
            <span class="o">&lt;/</span><span class="n">Route</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">Route</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">Main</span> <span class="o">/&gt;</span>
            <span class="o">&lt;/</span><span class="n">Route</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">Switch</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">BrowserRouter</span><span class="o">&gt;</span><span class="p">),</span>
    <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&quot;root&quot;</span><span class="p">))</span>
</code></pre></div>


<p>如果需要在路由组件中使用history，需要进行改造</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="p">{</span><span class="n">withRouter</span><span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;react-router-dom&#39;</span>

<span class="k">class</span> <span class="nc">Register</span> <span class="p">{</span>
    <span class="o">//...</span>
<span class="p">}</span>

<span class="n">export</span> <span class="n">default</span> <span class="n">withRouter</span><span class="p">(</span><span class="n">Register</span><span class="p">)</span>
</code></pre></div>


<h3>状态管理</h3>
<div class="highlight"><pre><span></span><code><span class="n">npm</span> <span class="n">install</span> <span class="o">--</span><span class="n">save</span> <span class="n">redux</span><span class="mf">@3.7.2</span> <span class="n">react</span><span class="o">-</span><span class="n">redux</span> <span class="n">redux</span><span class="o">-</span><span class="n">thunk</span>
<span class="n">npm</span> <span class="n">install</span> <span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">dev</span> <span class="n">redux</span><span class="o">-</span><span class="n">devtools</span><span class="o">-</span><span class="n">extension</span>
</code></pre></div>


<p>redux模块结构</p>
<div class="highlight"><pre><span></span><code><span class="err">src/redux</span>
<span class="err">├── action-types.js action常量</span>
<span class="err">├── actions.js action工厂函数</span>
<span class="err">├── reducers.js 所有的reducers函数(state, action) =&gt; newstate</span>
<span class="err">└── store.js 核心对象</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="c1">// reducers.js</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">combineReducers</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;redux&#39;</span>

<span class="kd">function</span> <span class="nx">xxx</span><span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">state</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">yyy</span><span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">state</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">combineReducers</span><span class="p">({</span><span class="nx">xxx</span><span class="p">,</span> <span class="nx">yyy</span><span class="p">})</span>

<span class="c1">// state结构 {xxx: 0, yyy: 0}</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="c1">// store.js 固定写法</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">createStore</span><span class="p">,</span> <span class="nx">applyMiddleware</span><span class="p">}</span> <span class="nx">from</span> <span class="s2">&quot;redux&quot;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">thunk</span> <span class="nx">from</span> <span class="s2">&quot;redux-thunk&quot;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">composeWithDevTools</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;redux-devtools-extension&#39;</span>

<span class="kr">import</span> <span class="nx">reducers</span> <span class="nx">from</span> <span class="s1">&#39;./reducers&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">reducers</span><span class="p">,</span> <span class="nx">composeWithDevTools</span><span class="p">(</span><span class="nx">applyMiddleware</span><span class="p">(</span><span class="nx">thunk</span><span class="p">)))</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="o">//</span> <span class="err">入口</span><span class="n">js代码</span>

<span class="kn">import</span> <span class="nn">React</span> <span class="nn">from</span> <span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">ReactDOM</span> <span class="nn">from</span> <span class="s2">&quot;react-dom&quot;</span>
<span class="kn">import</span> <span class="p">{</span><span class="n">BrowserRouter</span><span class="p">,</span> <span class="n">Route</span><span class="p">,</span> <span class="n">Switch</span><span class="p">}</span> <span class="kn">from</span> <span class="s2">&quot;react-router-dom&quot;</span>
<span class="kn">import</span> <span class="p">{</span><span class="n">Provider</span><span class="p">}</span> <span class="kn">from</span> <span class="s2">&quot;react-redux&quot;</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">Register</span> <span class="nn">from</span> <span class="s2">&quot;./containers/register/register&quot;</span>
<span class="kn">import</span> <span class="nn">Login</span> <span class="nn">from</span> <span class="s2">&quot;./containers/login/login&quot;</span>
<span class="kn">import</span> <span class="nn">Main</span> <span class="nn">from</span> <span class="s2">&quot;./containers/main/main&quot;</span>
<span class="kn">import</span> <span class="nn">store</span> <span class="nn">from</span> <span class="s2">&quot;./redux/store&quot;</span><span class="p">;</span>

<span class="n">ReactDOM</span><span class="o">.</span><span class="n">render</span><span class="p">((</span>
    <span class="o">&lt;</span><span class="n">Provider</span> <span class="n">store</span><span class="o">=</span><span class="p">{</span><span class="n">store</span><span class="p">}</span> <span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">BrowserRouter</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">Switch</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">Route</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/register&quot;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="n">Register</span> <span class="o">/&gt;</span>
                <span class="o">&lt;/</span><span class="n">Route</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">Route</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/login&quot;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="n">Login</span> <span class="o">/&gt;</span>
                <span class="o">&lt;/</span><span class="n">Route</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">Route</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="n">Main</span> <span class="o">/&gt;</span>
                <span class="o">&lt;/</span><span class="n">Route</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">Switch</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">BrowserRouter</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">Provider</span><span class="o">&gt;</span>
    <span class="p">),</span>
    <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&quot;root&quot;</span><span class="p">))</span>
</code></pre></div>


<p>使用chrome插件可以看到效果
<img alt="插件效果" src="./img/redux-start.png"></p>
  </div>



        </div>

          <div class="col-md-3">
  <div class="well">

    <p><abbr title="2020-06-06T13:34:00+08:00"><i class="fa fa-calendar"></i> 六 06 六月 2020</abbr></p>

      <p><address>
        <i class="fa fa-user"></i> By
          <a href="/author/hester.html" rel="author">Hester</a>
      </address></p>

    <hr/>

      <p>
              <a href="/category/front-end-note.html" rel="tag"
                  data-toggle="tooltip" class="label label-info"
                  title="4 articles in this category">Front End Note</a>
      </p>
      <hr/>



  </div>
            
          </div>

      </div>

    </div>

    <!-- TODO: make footer sticky -->
    <footer class="container-fluid">
      <div class="container">
        <div class="row">

            <div class="col-md-2">
                <h5>Social</h5>
                <ul class="list-unstyled">
                  <li>  <a href="#">
      <i class="fa fa-external-link"></i>
    You can add links in your config file
  </a></li>
                  <li>  <a href="#">
      <i class="fa fa-external-link"></i>
    Another social link
  </a></li>
                </ul>
            </div>
            <div class="col-md-2">
                <h5>Links</h5>
                <ul class="list-unstyled">
                  <li>  <a href="http://getpelican.com/">
      <img src="https://icons.better-idea.org/icon?url=getpelican.com&size=16" width="16" height="16" class="icon" alt="getpelican.com icon"/>
    Pelican
  </a></li>
                  <li>  <a href="http://python.org/">
      <img src="https://icons.better-idea.org/icon?url=python.org&size=16" width="16" height="16" class="icon" alt="python.org icon"/>
    Python.org
  </a></li>
                  <li>  <a href="http://jinja.pocoo.org/">
      <img src="https://icons.better-idea.org/icon?url=jinja.pocoo.org&size=16" width="16" height="16" class="icon" alt="jinja.pocoo.org icon"/>
    Jinja2
  </a></li>
                  <li>  <a href="#">
      <i class="fa fa-external-link"></i>
    You can modify those links in your config file
  </a></li>
                </ul>
            </div>

          <div class="col-md-2">
            <h5>Browse content by</h5>
            <ul class="list-unstyled">
            </ul>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Copyright notice</h5>
            <p>© Copyright 2017-2021 Hester.</p>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Disclaimer</h5>
              <p>All opinions expressed in this site are my own personal opinions and are not endorsed by, nor do they represent the opinions of my previous, current and future employers or any of its affiliates, partners or customers.</p>
          </div>

          <div class="col-md-2">
          </div>

        </div>
      </div>

      <h5 class="text-right"><a href="#"><i class="fa fa-arrow-up"></i> Back to top</a></h5>

      <div class="container">
        <div class="row col-md-12 text-muted text-center">
          Site generated by <a href="https://getpelican.com"> Pelican</a>.<br/>
          <a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="https://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
      </div>

    </footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script src="/theme/js/jquery.mglass.js"></script>
    <script src="/theme/js/application.js"></script>

  </body>
</html>